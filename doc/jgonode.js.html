<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: jgonode.js</title>
    
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">
    
    <h1 class="page-title">Source: jgonode.js</h1>
    
    


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// Import or create JGO namespace
var JGO = JGO || {};

(function() {
    'use strict';

    /**
    * Helper class to store node information, apply and revert changes easily.
    *
    * @param {JGO.Board} jboard Board object to make changes on.
    * @param {JGO.Node} parent Parent node or null if no parent.
    * @param {Object} info Node information - ko coordinate, comment, etc.
    * @constructor
    * @memberof JGO
    */
    JGO.Node = function(jboard, parent, info) {
        this.jboard = jboard;
        this.parent = parent;
        this.info = info ? JGO.extend({}, info) : {};
        this.children = [];
        this.changes = [];

        if(parent) {
            parent.children.push(this); // register child
            this.captures = JGO.extend({}, parent.captures); // inherit
        } else {
            this.captures = {};
            this.captures[JGO.WHITE] = this.captures[JGO.BLACK] = 0;
        }
    };

    /**
    * Helper method to make changes to a board while saving them in the node.
    *
    * @param {Object} c JGO.Coordinate or array of them.
    * @param {int} val Type.
    */
    JGO.Node.prototype.setType = function(c, val) {
        if(c instanceof Array) {
            for(var i=0, len=c.length; i&lt;len; ++i)
                this.setType(c[i], val); // avoid repeating ourselves
            return;
        }

        // Store both change and previous value to enable reversion
        this.changes.push({c: c.copy(), type: val, old: this.jboard.getType(c)});
        this.jboard.setType(c, val);
    };

    /**
    * Helper method to make changes to a board while saving them in the node.
    *
    * @param {Object} c JGO.Coordinate or array of them.
    * @param {int} val Mark.
    */
    JGO.Node.prototype.setMark = function(c, val) {
        if(c instanceof Array) {
            for(var i=0, len=c.length; i&lt;len; ++i)
                this.setMark(c[i], val); // avoid repeating ourselves
            return;
        }

        // Store both change and previous value to enable reversion
        this.changes.push({c: c.copy(), mark: val, old: this.jboard.getMark(c)});
        this.jboard.setMark(c, val);
    };


    /**
    * Apply changes of this node to board.
    */
    JGO.Node.prototype.apply = function() {
        for(var i=0; i&lt;this.changes.length; i++) {
            var item = this.changes[i];

            if('type' in item)
                this.jboard.setType(item.c, item.type);
            else
                this.jboard.setMark(item.c, item.mark);
        }
    };

    /**
    * Revert changes of this node to board.
    */
    JGO.Node.prototype.revert = function() {
        for(var i=this.changes.length-1; i>=0; i--) {
            var item = this.changes[i];

            if('type' in item)
                this.jboard.setType(item.c, item.old);
            else
                this.jboard.setMark(item.c, item.old);
        }
    };

})();
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="JGO.Board.html">Board</a></li><li><a href="JGO.Canvas.html">Canvas</a></li><li><a href="JGO.Coordinate.html">Coordinate</a></li><li><a href="JGO.Node.html">Node</a></li><li><a href="JGO.Notifier.html">Notifier</a></li><li><a href="JGO.Record.html">Record</a></li><li><a href="JGO.Setup.html">Setup</a></li></ul><h3>Namespaces</h3><ul><li><a href="JGO.html">JGO</a></li><li><a href="JGO.util.html">util</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha3</a> on Fri Jan 10 2014 23:19:29 GMT+0200 (FLE Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
