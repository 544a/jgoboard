<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Board</title>
  <style type="text/css">
    /*body {
      background-color: #eeeeee;
    }*/
  </style>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
</head>
<body>

<div id="board"></div>

<script type="text/javascript" src="jgoinit.js"></script>
<script type="text/javascript" src="jgoconstants.js"></script>
<script type="text/javascript" src="jgocoordinate.js"></script>
<script type="text/javascript" src="jgoboard.js"></script>
<script type="text/javascript" src="jgocanvas.js"></script>
<script type="text/javascript" src="jgonotifier.js"></script>
<script type="text/javascript" src="jgosetup.js"></script>
<script type="text/javascript" src="jgonode.js"></script>
<script type="text/javascript" src="jgorecord.js"></script>
<script type="text/javascript" src="jgoutil.js"></script>
<script type="text/javascript" src="jgosgf.js"></script>
<script type="text/javascript" src="large/board.js"></script>

<script type="text/javascript">
var jrecord = new JGO.Record(13);
var jboard = jrecord.jboard;
var jsetup = new JGO.Setup(jboard, JGO.BOARD.largeWalnut);
var player = JGO.WHITE; // next player
var handi = JGO.util.getHandicapCoordinates(jboard.width, 2);
var ko = false, lastMove = false;

jrecord.createNode();
jrecord.getCurrentNode().setType(handi, JGO.BLACK);

jsetup.setOptions({stars: {points:5}});
jsetup.create('board', function(canvas) {
  canvas.addListener('click', function(coord, ev) {
    var node = jrecord.getCurrentNode();
    var opponent = (player == JGO.BLACK) ? JGO.WHITE : JGO.BLACK;

    //if(ev.shiftKey) { // on shift do edit
    //  var type = jboard.getType(coord);

    //  if(node.type != JGO.NONE)
    //    node = jrecord.createNode(); // new node

    //  node.setType(coord, type == JGO.WHITE ? JGO.CLEAR : type + 1);
    //  return;
    //}

    var play = jboard.playMove(coord, player, ko);

    if(play.success) {
      node = jrecord.createNode({type: player});

      node.setType(coord, player); // play stone
      node.setType(play.captures, JGO.CLEAR); // clear opponent's stones

      if(lastMove)
        node.setMark(lastMove, JGO.MARK.NONE); // clear previous mark
      if(ko)
        node.setMark(coord, JGO.MARK.NONE); // clear previous ko mark

      node.setMark(coord, JGO.MARK.CIRCLE); // mark move
      lastMove = coord;

      if(play.ko)
        node.setMark(play.ko, JGO.MARK.CIRCLE); // mark ko, too
      ko = play.ko;

      player = opponent;
    } else alert('Illegal move: ' + play.errorMsg);
  });
});
</script>

</body>
</html>
