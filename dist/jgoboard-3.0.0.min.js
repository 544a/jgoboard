/*! jgoboard 3.0.0, (c) Joonas Pihlajamaa. Licensed under CC-BY-NC-4.0, see http://jgoboard.com for details. */
var JGO=JGO||{};!function(){"use strict";Object.prototype.keys||(Object.prototype.keys=function(){var a=[];for(var b in this)this.hasOwnProperty(b)&&a.push(b);return a}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var c=b||0,d=this.length;d>c;c++)if(this[c]===a)return c;return-1}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),JGO.extend=function(a,b){for(var c in b)b.hasOwnProperty(c)&&("object"==typeof b[c]?(a[c]&&"object"==typeof a[c]||(a[c]={}),JGO.extend(a[c],b[c])):a[c]=b[c]);return a}}();var JGO=JGO||{};!function(){"use strict";JGO.Board=function(a,b){this.width=a,this.height=void 0!==b?b:this.width,this.listeners=[],this.stones=[],this.marks=[];for(var c=0;c<this.width;++c){for(var d=[],e=[],f=0;f<this.height;++f)d.push(JGO.CLEAR),e.push(JGO.MARK.NONE);this.stones.push(d),this.marks.push(e)}},JGO.Board.prototype.addListener=function(a,b){this.listeners.push({type:a,mark:b})},JGO.Board.prototype.getCoordinate=function(a){return new JGO.Coordinate(JGO.COORDINATES.indexOf(a.toUpperCase().substr(0,1)),this.height-parseInt(a.substr(1)))},JGO.Board.prototype.toString=function(a){return JGO.COORDINATES[a.i]+(this.height-a.j)},JGO.Board.prototype.each=function(a,b,c,d,e){var f=new JGO.Coordinate;for(void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=this.width-1),void 0===e&&(e=this.height-1),f.j=c;f.j<=e;f.j++)for(f.i=b;f.i<=d;f.i++)a.call(this,f.copy(),this.stones[f.i][f.j],this.marks[f.i][f.j])},JGO.Board.prototype.clear=function(){this.each(function(a){this.setType(a,JGO.CLEAR),this.setMark(a,JGO.MARK.NONE)})},JGO.Board.prototype.setType=function(a,b){if(a instanceof JGO.Coordinate){var c=this.stones[a.i][a.j];if(c==b)return;this.stones[a.i][a.j]=b;for(var d=0;d<this.listeners.length;++d)this.listeners[d].type.call(this,a,b,c)}else if(a instanceof Array)for(var e=0,f=a.length;f>e;++e)this.setType(a[e],b)},JGO.Board.prototype.setMark=function(a,b){if(a instanceof JGO.Coordinate){var c=this.marks[a.i][a.j];if(c==b)return;this.marks[a.i][a.j]=b;for(var d=0;d<this.listeners.length;++d)this.listeners[d].mark.call(this,a,b,c)}else if(a instanceof Array)for(var e=0,f=a.length;f>e;++e)this.setMark(a[e],b)},JGO.Board.prototype.getType=function(a){var b;if(a instanceof JGO.Coordinate)b=this.stones[a.i][a.j];else if(a instanceof Array){b=[];for(var c=0,d=a.length;d>c;++c)b.push(this.stones[a[c].i][a[c].j])}return b},JGO.Board.prototype.getMark=function(a){var b;if(a instanceof JGO.Coordinate)b=this.marks[a.i][a.j];else if(a instanceof Array){b=[];for(var c=0,d=a.length;d>c;++c)b.push(this.marks[a[c].i][a[c].j])}return b},JGO.Board.prototype.getAdjacent=function(a){var b=[],c=a.i,d=a.j;return c>0&&b.push(new JGO.Coordinate(c-1,d)),c+1<this.width&&b.push(new JGO.Coordinate(c+1,d)),d>0&&b.push(new JGO.Coordinate(c,d-1)),d+1<this.height&&b.push(new JGO.Coordinate(c,d+1)),b},JGO.Board.prototype.filter=function(a,b){for(var c=[],d=0,e=a.length;e>d;++d)this.stones[a[d].i][a[d].j]==b&&c.push(a);return c},JGO.Board.prototype.hasType=function(a,b){for(var c=0,d=a.length;d>c;++c)if(this.stones[a[c].i][a[c].j]==b)return!0;return!1},JGO.Board.prototype.getGroup=function(a,b){var c=b||this.getType(a),d={},e=[a.copy()],f=[],g=this.getAdjacent(a);for(d[a.toString()]=!0;g.length;){var h=g.shift();h.toString()in d||(d[h.toString()]=!0,this.getType(h)==c?(e.push(h),g=g.concat(this.getAdjacent(h))):f.push(h))}return{group:e,neighbors:f}},JGO.Board.prototype.getRaw=function(){return{width:this.width,height:this.height,stones:JGO.extend({},this.stones),marks:JGO.extend({},this.marks)}},JGO.Board.prototype.setRaw=function(a){this.width=a.width,this.height=a.height,this.stones=a.stones,this.marks=a.marks},JGO.Board.prototype.playMove=function(a,b,c){var d,e=b==JGO.BLACK?JGO.WHITE:JGO.BLACK,f=[];if(!a)return{success:!0,captures:[],ko:!1};if(this.getType(a)!=JGO.CLEAR)return{success:!1,errorMsg:"Cannot play on existing stone!"};if(c&&a.equals(c))return{success:!1,errorMsg:"Cannot retake ko immediately!"};d=this.getAdjacent(a);for(var g=0;g<d.length;g++){var h=d[g];if(this.getType(h)==e){var i=this.getGroup(h);1==this.filter(i.neighbors,JGO.CLEAR).length&&(f=f.concat(i.group))}}return 0!==f.length||this.hasType(this.getGroup(a,b).neighbors,JGO.CLEAR)?1!=f.length||this.filter(d,JGO.CLEAR).length?{success:!0,captures:f,ko:!1}:{success:!0,captures:f,ko:f[0].copy()}:{success:!1,errorMsg:"Suicide is not allowed!"}}}();var JGO=JGO||{};!function(){"use strict";JGO.Canvas=function(a,b,c){var d,e,f=document.getElementById(a),g=document.createElement("canvas"),h=this,i=b.edge.left?b.padding.normal:b.padding.clipped,j=b.edge.right?b.padding.normal:b.padding.clipped,k=b.edge.top?b.padding.normal:b.padding.clipped,l=b.edge.bottom?b.padding.normal:b.padding.clipped;this.marginLeft=b.edge.left?b.margin.normal:b.margin.clipped,this.marginRight=b.edge.right?b.margin.normal:b.margin.clipped,this.marginTop=b.edge.top?b.margin.normal:b.margin.clipped,this.marginBottom=b.edge.bottom?b.margin.normal:b.margin.clipped,this.boardWidth=i+j+b.grid.x*b.view.width,this.boardHeight=k+l+b.grid.y*b.view.height,this.width=g.width=this.marginLeft+this.marginRight+this.boardWidth,this.height=g.height=this.marginTop+this.marginBottom+this.boardHeight,this.listeners={click:[],mousemove:[],mouseout:[]},this.getCoordinate=function(a,c){var d=g.getBoundingClientRect(),e=(a-d.left)*g.width/(d.right-d.left),f=(c-d.top)*g.height/(d.bottom-d.top);return new JGO.Coordinate(Math.floor((e-h.marginLeft-i)/b.grid.x)+b.view.xOffset,Math.floor((f-h.marginTop-k)/b.grid.y)+b.view.yOffset)},g.onclick=function(a){for(var b=h.getCoordinate(a.pageX,a.pageY),c=h.listeners.click,d=0;d<c.length;d++)c[d].call(h,b.copy(),a)};var m=new JGO.Coordinate(-1,-1);if(g.onmousemove=function(a){var b=h.getCoordinate(a.pageX,a.pageY),c=h.listeners.mousemove;if((b.i<h.opt.view.xOffset||b.i>=h.opt.view.xOffset+h.opt.view.width)&&(b.i=-1),(b.j<h.opt.view.yOffset||b.j>=h.opt.view.yOffset+h.opt.view.height)&&(b.j=-1),!m.equals(b)){m=b.copy();for(var d=0;d<c.length;d++)c[d].call(h,b.copy(),a)}},g.onmouseout=function(a){for(var b=h.listeners.mouseout,c=0;c<b.length;c++)b[c].call(h,a)},f.appendChild(g),this.ctx=g.getContext("2d"),this.opt=b,this.img=c,this.ctx.fillStyle=b.margin.color,this.ctx.fillRect(0,0,g.width,g.height),c.board){this.ctx.save(),this.ctx.shadowColor=b.boardShadow.color,this.ctx.shadowBlur=b.boardShadow.blur,this.ctx.shadowOffsetX=b.boardShadow.offX,this.ctx.shadowOffsetX=b.boardShadow.offY;var n=b.edge.top?0:this.marginTop,o=b.edge.left?0:this.marginLeft,p=b.edge.bottom?0:this.marginBottom,q=b.edge.right?0:this.marginRight;this.ctx.beginPath(),this.ctx.rect(o,n,g.width-o-q,g.height-n-p),this.ctx.clip(),this.ctx.drawImage(c.board,0,0,this.boardWidth,this.boardHeight,this.marginLeft,this.marginTop,this.boardWidth,this.boardHeight),this.ctx.strokeStyle=b.border.color,this.ctx.lineWidth=b.border.lineWidth,this.ctx.beginPath(),this.ctx.rect(this.marginLeft,this.marginTop,this.boardWidth,this.boardHeight),this.ctx.stroke(),this.ctx.restore()}this.gridTop=this.marginTop+k+b.grid.y/2,this.gridLeft=this.marginLeft+i+b.grid.x/2,this.ctx.strokeStyle=b.grid.color;var r=this.opt.grid.smooth;for(d=0;d<b.view.width;d++)this.ctx.lineWidth=0===d&&b.edge.left||d+1==b.view.width&&b.edge.right?b.grid.borderWidth:b.grid.lineWidth,this.ctx.beginPath(),this.ctx.moveTo(r+this.gridLeft+b.grid.x*d,r+this.gridTop-(b.edge.top?0:b.grid.y/2+k/2)),this.ctx.lineTo(r+this.gridLeft+b.grid.x*d,r+this.gridTop+b.grid.y*(b.view.height-1)+(b.edge.bottom?0:b.grid.y/2+l/2)),this.ctx.stroke();for(d=0;d<b.view.height;d++)this.ctx.lineWidth=0===d&&b.edge.top||d+1==b.view.height&&b.edge.bottom?b.grid.borderWidth:b.grid.lineWidth,this.ctx.beginPath(),this.ctx.moveTo(r+this.gridLeft-(b.edge.left?0:b.grid.x/2+i/2),r+this.gridTop+b.grid.y*d),this.ctx.lineTo(r+this.gridLeft+b.grid.x*(b.view.width-1)+(b.edge.right?0:b.grid.x/2+j/2),r+this.gridTop+b.grid.y*d),this.ctx.stroke();if(b.stars.points){var s=(b.board.width-1)/2-b.stars.offset;for(e=0;3>e;e++)for(d=0;3>d;d++){if(1==e&&1==d){if(b.stars.points%2===0)continue}else if(1==d||1==e){if(b.stars.points<8)continue}else if(b.stars.points<4)continue;var t=b.stars.offset+d*s-b.view.xOffset,u=b.stars.offset+e*s-b.view.yOffset;0>t||0>u||t>=b.view.width||u>=b.view.height||(this.ctx.beginPath(),this.ctx.arc(r+this.gridLeft+t*b.grid.x,r+this.gridTop+u*b.grid.y,b.stars.radius,2*Math.PI,!1),this.ctx.fillStyle=b.grid.color,this.ctx.fill())}}for(this.ctx.font=b.coordinates.font,this.ctx.fillStyle=b.coordinates.color,this.ctx.textAlign="center",this.ctx.textBaseline="middle",d=0;d<b.view.width;d++)b.coordinates&&b.coordinates.top&&this.ctx.fillText(JGO.COORDINATES[d+b.view.xOffset],this.gridLeft+b.grid.x*d,this.marginTop/2),b.coordinates&&b.coordinates.bottom&&this.ctx.fillText(JGO.COORDINATES[d+b.view.xOffset],this.gridLeft+b.grid.x*d,g.height-this.marginBottom/2);for(d=0;d<b.view.height;d++)b.coordinates&&b.coordinates.left&&this.ctx.fillText(""+(b.board.height-b.view.yOffset-d),this.marginLeft/2,this.gridTop+b.grid.y*d),b.coordinates&&b.coordinates.right&&this.ctx.fillText(""+(b.board.height-b.view.yOffset-d),g.width-this.marginRight/2,this.gridTop+b.grid.y*d);this.backup=document.createElement("canvas"),this.backup.width=g.width,this.backup.height=g.height,this.backup.getContext("2d").drawImage(g,0,0,g.width,g.height,0,0,g.width,g.height),this.restore=function(a,b,c,d){this.ctx.drawImage(this.backup,a,b,c,d,a,b,c,d)},this.ctx.beginPath(),this.ctx.rect(this.marginLeft,this.marginTop,this.boardWidth,this.boardHeight),this.ctx.clip()},JGO.Canvas.prototype.getX=function(a){return this.gridLeft+this.opt.grid.x*a},JGO.Canvas.prototype.getY=function(a){return this.gridTop+this.opt.grid.y*a},JGO.Canvas.prototype.draw=function(a,b,c,d,e){var f=this;if(b=Math.max(b,this.opt.view.xOffset),c=Math.max(c,this.opt.view.yOffset),d=Math.min(d,this.opt.view.xOffset+this.opt.view.width-1),e=Math.min(e,this.opt.view.yOffset+this.opt.view.height-1),!(b>d||c>e)){var g=this.getX(b-this.opt.view.xOffset)-this.opt.grid.x,h=this.getY(c-this.opt.view.yOffset)-this.opt.grid.y,i=this.opt.grid.x*(d-b+2),j=this.opt.grid.y*(e-c+2);this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(g,h,i,j),this.ctx.clip(),this.restore(g,h,i,j),b=Math.max(b-1,this.opt.view.xOffset),c=Math.max(c-1,this.opt.view.yOffset),d=Math.min(d+1,this.opt.view.xOffset+this.opt.view.width-1),e=Math.min(e+1,this.opt.view.yOffset+this.opt.view.height-1);var k,l=/^[a-zA-Z1-9]/,m=this.opt.stone.radius,n=1.5*m,o=1.2*m,p=1.1*m,q=1.1*m,r=.5*m,s=.9*m;this.img.board?k=function(a,b){f.ctx.drawImage(f.img.board,a-f.marginLeft-n/2,b-f.marginTop-o/2,n,o,a-n/2,b-o/2,n,o)}:(this.ctx.fillStyle=this.opt.margin.color,k=function(a,b){f.ctx.fillRect(a-n/2,b-o/2,n,o)}),a.each(function(a,b,c){var d=.5+f.getX(a.i-f.opt.view.xOffset),e=.5+f.getY(a.j-f.opt.view.yOffset);b==JGO.CLEAR&&c&&l.test(c)&&k(d,e)},b,c,d,e),this.img.shadow&&a.each(function(a,b){var c=.5+f.getX(a.i-f.opt.view.xOffset),d=.5+f.getY(a.j-f.opt.view.yOffset);switch(b){case JGO.BLACK:case JGO.WHITE:f.ctx.drawImage(f.img.shadow,f.opt.shadow.xOff+c-f.img.shadow.width/2,f.opt.shadow.yOff+d-f.img.shadow.height/2)}},b,c,d,e);var t,u,v,w;this.img.white&&this.img.black?(u=function(a,b){f.ctx.drawImage(f.img.black,a-f.img.black.width/2,b-f.img.black.height/2)},w=function(a,b){f.ctx.drawImage(f.img.black,0,0,f.img.black.width,f.img.black.height,a-f.img.black.width/4,b-f.img.black.height/4,f.img.black.width/2,f.img.black.height/2)},t=function(a,b){f.ctx.drawImage(f.img.white,a-f.img.white.width/2,b-f.img.white.height/2)},v=function(a,b){f.ctx.drawImage(f.img.white,0,0,f.img.white.width,f.img.white.height,a-f.img.white.width/4,b-f.img.white.height/4,f.img.white.width/2,f.img.white.height/2)}):(u=function(a,b){f.ctx.fillStyle="#000000",f.ctx.beginPath(),f.ctx.arc(a,b,m,2*Math.PI,!1),f.ctx.fill()},w=function(a,b){f.ctx.fillStyle="#000000",f.ctx.beginPath(),f.ctx.arc(a,b,m/2,2*Math.PI,!1),f.ctx.fill()},t=function(a,b){f.ctx.fillStyle="#FFFFFF",f.ctx.strokeStyle="#000000",f.ctx.beginPath(),f.ctx.arc(a,b,m,2*Math.PI,!1),f.ctx.fill(),f.ctx.stroke()},v=function(a,b){f.ctx.fillStyle="#FFFFFF",f.ctx.strokeStyle="#000000",f.ctx.beginPath(),f.ctx.arc(a,b,m/2,2*Math.PI,!1),f.ctx.fill(),f.ctx.stroke()}),a.each(function(a,b,c){var d,e,g=.5+f.getX(a.i-f.opt.view.xOffset),h=.5+f.getY(a.j-f.opt.view.yOffset);switch(b){case JGO.DIM_BLACK:f.ctx.globalAlpha=f.opt.stone.dimAlpha,u(g,h),d=f.opt.mark.blackColor;break;case JGO.BLACK:f.ctx.globalAlpha=1,u(g,h),d=f.opt.mark.blackColor;break;case JGO.DIM_WHITE:f.ctx.globalAlpha=f.opt.stone.dimAlpha,t(g,h),d=f.opt.mark.whiteColor;break;case JGO.WHITE:f.ctx.globalAlpha=1,t(g,h),d=f.opt.mark.whiteColor;break;default:f.ctx.globalAlpha=1,d=f.opt.mark.clearColor}if(f.ctx.lineWidth=f.opt.mark.lineWidth,f.ctx.strokeStyle=d,f.ctx.font=f.opt.mark.font,f.ctx.fillStyle=d,f.ctx.textAlign="center",f.ctx.textBaseline="middle",c)switch(c){case JGO.MARK.SQUARE:f.ctx.beginPath(),f.ctx.rect(g-p/2,h-q/2,p,q),f.ctx.stroke();break;case JGO.MARK.CROSS:f.ctx.beginPath(),f.ctx.moveTo(g-p/2,h+q/2),f.ctx.lineTo(g+p/2,h-q/2),f.ctx.moveTo(g-p/2,h-q/2),f.ctx.lineTo(g+p/2,h+q/2),f.ctx.stroke();break;case JGO.MARK.TRIANGLE:for(f.ctx.beginPath(),e=0;3>e;e++)f.ctx.moveTo(g+s*Math.cos(Math.PI*(.5+2*e/3)),h-s*Math.sin(Math.PI*(.5+2*e/3))),f.ctx.lineTo(g+s*Math.cos(Math.PI*(.5+2*(e+1)/3)),h-s*Math.sin(Math.PI*(.5+2*(e+1)/3)));f.ctx.stroke();break;case JGO.MARK.CIRCLE:f.ctx.beginPath(),f.ctx.arc(g,h,r,2*Math.PI,!1),f.ctx.stroke();break;case JGO.MARK.BLACK_TERRITORY:f.ctx.globalAlpha=1,v();break;case JGO.MARK.WHITE_TERRITORY:f.ctx.globalAlpha=1,v();break;case JGO.MARK.SELECTED:f.ctx.globalAlpha=.5,f.ctx.fillStyle="#8080FF",f.ctx.fillRect(g-f.opt.grid.x/2,h-f.opt.grid.y/2,f.opt.grid.x,f.opt.grid.y);break;default:f.ctx.fillText(c,g,h)}},b,c,d,e),this.ctx.restore()}},JGO.Canvas.prototype.addListener=function(a,b){this.listeners[a].push(b)}}();var JGO=JGO||{};!function(){"use strict";JGO.INTERSECTION={CLEAR:0,BLACK:1,WHITE:2,DIM_BLACK:3,DIM_WHITE:4},JGO.extend(JGO,JGO.INTERSECTION),JGO.MARK={NONE:"",SELECTED:"^",SQUARE:"#",TRIANGLE:"/",CIRCLE:"0",CROSS:"*",BLACK_TERRITORY:",",WHITE_TERRITORY:"."},JGO.COORDINATES="ABCDEFGHJKLMNOPQRSTUVWXYZ".split("")}();var JGO=JGO||{};!function(){"use strict";var a="abcdefghijklmnopqrstuvwxyz".split("");JGO.Coordinate=function(b,c){if(void 0!==b)if(void 0!==c)this.i=b,this.j=c;else{if(this.i=0,this.j=0,"string"!=typeof b)return;b=b.toLowerCase(),this.i=a.indexOf(b.substr(0,1)),this.j=a.indexOf(b.substr(1))}else this.i=0,this.j=0},JGO.Coordinate.prototype.equals=function(a){return a.i==this.i&&a.j==this.j},JGO.Coordinate.prototype.toString=function(){return a[this.i]+a[this.j]},JGO.Coordinate.prototype.copy=function(){return new JGO.Coordinate(this.i,this.j)}}();var JGO=JGO||{};!function(){"use strict";JGO.Node=function(a,b,c){this.jboard=a,this.parent=b,this.info=c?JGO.extend({},c):{},this.children=[],this.changes=[],b?(b.children.push(this),this.captures=JGO.extend({},b.captures)):(this.captures={},this.captures[JGO.WHITE]=this.captures[JGO.BLACK]=0)},JGO.Node.prototype.setType=function(a,b){if(a instanceof Array)for(var c=0,d=a.length;d>c;++c)this.setType(a[c],b);else this.changes.push({c:a.copy(),type:b,old:this.jboard.getType(a)}),this.jboard.setType(a,b)},JGO.Node.prototype.setMark=function(a,b){if(a instanceof Array)for(var c=0,d=a.length;d>c;++c)this.setMark(a[c],b);else this.changes.push({c:a.copy(),mark:b,old:this.jboard.getMark(a)}),this.jboard.setMark(a,b)},JGO.Node.prototype.apply=function(){for(var a=0;a<this.changes.length;a++){var b=this.changes[a];"type"in b?this.jboard.setType(b.c,b.type):this.jboard.setMark(b.c,b.mark)}},JGO.Node.prototype.revert=function(){for(var a=this.changes.length-1;a>=0;a--){var b=this.changes[a];"type"in b?this.jboard.setType(b.c,b.old):this.jboard.setMark(b.c,b.old)}}}();var JGO=JGO||{};!function(){"use strict";JGO.Notifier=function(a){var b=this,c=function(c){return b.changed?(b.min.i=Math.min(b.min.i,c.i),b.min.j=Math.min(b.min.j,c.j),b.max.i=Math.max(b.max.i,c.i),b.max.j=Math.max(b.max.j,c.j),void 0):(b.min=c.copy(),b.max=c.copy(),b.changed=!0,setTimeout(function(){for(var c=0;c<b.canvases.length;c++)b.canvases[c].draw(a,b.min.i,b.min.j,b.max.i,b.max.j);b.changed=!1},0),void 0)};this.changed=!1,this.canvases=[],a.addListener(c,c)},JGO.Notifier.prototype.addCanvas=function(a){this.canvases.push(a)}}();var JGO=JGO||{};!function(){"use strict";JGO.Record=function(a,b){this.jboard=new JGO.Board(a,b?b:a),this.root=this.current=null,this.info={}},JGO.Record.prototype.getCurrentNode=function(){return this.current},JGO.Record.prototype.createNode=function(a){var b=new JGO.Node(this.jboard,this.current,a);return null===this.root&&(this.root=b),this.current=b},JGO.Record.prototype.next=function(a){return null===this.current?null:(a||(a=0),a>=this.current.children.length?null:(this.current=this.current.children[a],this.current.apply(this.jboard),this.current))},JGO.Record.prototype.previous=function(){return null===this.current||null===this.current.parent?null:(this.current.revert(this.jboard),this.current=this.current.parent,this.current)},JGO.Record.prototype.first=function(){return this.current=this.root,this.jboard.clear(),null!==this.current&&this.current.apply(this.jboard),this.current},JGO.Record.prototype.createSnapshot=function(){return{jboard:this.jboard.getRaw(),current:this.current}},JGO.Record.prototype.restoreSnapshot=function(a){this.jboard.setRaw(a.jboard),this.current=a.current}}();var JGO=JGO||{};!function(){"use strict";JGO.Setup=function(a,b){var c={margin:{color:"white"},edge:{top:!0,bottom:!0,left:!0,right:!0},coordinates:{top:!0,bottom:!0,left:!0,right:!0},stars:{points:0},board:{width:a.width,height:a.height},view:{xOffset:0,yOffset:0,width:a.width,height:a.height}};if(a.width==a.height)switch(a.width){case 9:c.stars.points=5,c.stars.offset=2;break;case 13:case 19:c.stars.points=9,c.stars.offset=3}this.jboard=a,this.jnotifier=new JGO.Notifier(a),this.options=JGO.extend(c,b)},JGO.Setup.prototype.view=function(a,b,c,d){this.options.view.xOffset=a,this.options.view.yOffset=b,this.options.view.width=c,this.options.view.height=d,this.options.edge.left=0===a,this.options.edge.right=a+c==this.options.board.width,this.options.edge.top=0===b,this.options.edge.bottom=b+d==this.options.board.height},JGO.Setup.prototype.setOptions=function(a){JGO.extend(this.options,a)},JGO.Setup.prototype.create=function(a,b){var c,d=this,e=this.jboard,f=JGO.extend({},this.options);c=function(c){var g=new JGO.Canvas(a,f,c);g.draw(e,0,0,e.width-1,e.height-1),d.jnotifier.addCanvas(g),b&&b(g)},this.options.textures?JGO.util.loadImages(this.options.textures,c):c({black:!1,white:!1,shadow:!1,board:!1})}}();var JGO=JGO||{};JGO.util=JGO.util||{},function(){"use strict";function a(a,b,c){var d,e,f,g;return"B"==b?(e=JGO.BLACK,f=JGO.WHITE):(e=JGO.WHITE,f=JGO.BLACK),d=2==c[0].length?new JGO.Coordinate(c[0]):null,g=a.jboard.playMove(d,e),g.success&&null!==d?(a.setType(d,e),a.setType(g.captures,JGO.CLEAR)):l=g.error,g.success}function b(a,b,c){var d={AB:JGO.BLACK,AW:JGO.WHITE,AE:JGO.CLEAR};return a.setType(h(c),d[b]),!0}function c(a,b,c){var d={TW:",",TB:".",CR:"0",TR:"/",MA:"*",SQ:"#"};return a.mark(h(c),d[b]),!0}function d(a,b,c){return a.comment=c[0],!0}function e(a,b,c){return a.info.handicap=c[0],!0}function f(a,b,c){for(var d=0;d<c.length;d++){var e=c[d],f=e.split(":");a.setMark(new JGO.Coordinate(f[0]),f[1])}return!0}function g(a,b,c){var d=m[b];return a.info[d]=c[0],!0}function h(a){for(var b=[],c=0,d=a.length;d>c;c++){var e=a[c];if(-1==e.indexOf(":"))b.push(new JGO.Coordinate(e));else{var f,g,h,i=e.split(":");for(f=new JGO.Coordinate(i[0]),g=new JGO.Coordinate(i[1]),h=new JGO.Coordinate,h.i=f.i;h.i<=g.i;++h.i)for(h.j=f.j;h.j<=g.j;++h.j)b.push(h.copy())}}return b}function i(a){var b,c,d,e,f=!1,g=-1,h=[];if(3==="a~b".split(/(~)/).length)b=a.split(/([\[\]\(\);])/);else{var i=0,j="[]();";for(b=[],c=0,d=a.length;d>c;++c)-1!==j.indexOf(a.charAt(c))&&(c>i&&b.push(a.substring(i,c)),b.push(a.charAt(c)),i=c+1);c>i&&b.push(a.substr(i,c))}for(c=0,d=b.length;d>c;++c)e=b[c],-1==g?(e=e.trim(),"["==e?g=c:""!==e&&h.push(e)):"]"!=e?f="\\"==e.charAt(e.length-1):f?f=!1:(h.push(b.slice(g,c+1).join("").replace(/\\\]/g,"]")),g=-1);if(0===h.length)return l="SGF was empty!",!1;if("("!=h[0]||";"!=h[1]||")"!=h[h.length-1])return l="SGF did not start with '(;' or end with ')'!",!1;b=h,h=[];var k,m="";for(c=0,d=b.length;d>c;++c)if(e=b[c],"("==e||")"==e){if(k){if(""!==m&&0===k[m].length)return l="Missing property value at "+e+"!",!1;h.push(k),k=void 0}h.push(e)}else if(";"==e){if(k){if(""!==m&&0===k[m].length)return l="Missing property value at "+e+"!",!1;h.push(k)}k={},m=""}else if(0!==e.indexOf("[")){if(""!==m&&0===k[m].length)return l="Missing property value at "+e+"!",!1;if(e in k)return l="Duplicate property identifier "+e+"!",!1;m=e,k[m]=[]}else{if(""===m)return l="Missing property identifier at "+e+"!",!1;k[m].push(e.substring(1,e.length-1))}b=h;var n,o=[],p={sequence:[],leaves:[]};for(c=1,d=b.length;d-1>c;++c)if(e=b[c],"("==e){if(0===p.sequence.length)return l="SGF contains a game tree without a sequence!",!1;o.push(p),p={sequence:[],leaves:[]}}else if(")"==e){if(0===p.sequence.length)return l="SGF contains a game tree without a sequence!",!1;n=p,p=o.pop(),p.leaves.push(n)}else p.sequence.push(e);return o.length>0?(l="Invalid number of parentheses in the SGF!",!1):p}function j(a){var b,c=a.sequence[0],d=19,e=19;if("SZ"in c){var f=c.SZ[0];-1!=f.indexOf(":")?(d=parseInt(f.substring(0,f.indexOf(":"))),e=parseInt(f.substr(f.indexOf(":")+1))):d=e=parseInt(f)}return b=new JGO.Record(d,e),k(b,a)?(b.first(),b):!1}function k(a,b){for(var c=0;c<b.sequence.length;c++){var d=b.sequence[c],e=a.createNode();for(var f in d)if(d.hasOwnProperty(f)){if(!(f in n))continue;if(!n[f](e,f,d[f]))return l="Error while parsing node "+f+": "+l,!1}}for(c=0;c<b.leaves.length;c++){var g,h=b.leaves[c];if(g=a.createSnapshot(),!k(a,h))return!1;a.restoreSnapshot(g)}return!0}var l,m={AN:"annotator",CP:"copyright",DT:"date",EV:"event",GN:"gameName",OT:"overtime",RO:"round",RE:"result",RU:"rules",SO:"source",TM:"time",PC:"location",PB:"black",PW:"white",BR:"blackRank",WR:"whiteRank",BT:"blackTeam",WT:"whiteTeam"},n={B:a,W:a,AB:b,AW:b,AE:b,C:d,LB:f,HA:e,TW:c,TB:c,CR:c,TR:c,MA:c,SQ:c,AN:g,CP:g,DT:g,EV:g,GN:g,OT:g,RO:g,RE:g,RU:g,SO:g,TM:g,PC:g,PB:g,PW:g,BR:g,WR:g,BT:g,WT:g};JGO.util.loadSGF=function(a){var b=i(a);if(0===b.sequence.length){var c=[];if(0===b.leaves.length)return"Empty game tree!";for(var d=0;d<b.leaves.length;d++){var e=j(b);if(!e)return l;c.push(e)}return c}return j(b)}}();var JGO=JGO||{};JGO.util=JGO.util||{},function(){"use strict";JGO.util.loadImages=function(a,b){var c={},d=0;for(var e in a)a.hasOwnProperty(e)&&a[e]&&d++;var f=function(){--d<=0&&b(c)};for(e in a)a.hasOwnProperty(e)&&a[e]&&(c[e]=new Image,c[e].onload=f,c[e].src=a[e])},JGO.util.getHandicapCoordinates=function(a,b){var c=[[],[],[3,7],[3,7,9],[1,3,7,9],[1,3,5,7,9],[1,3,4,6,7,9],[1,3,4,5,6,7,9],[1,2,3,4,6,7,8,9],[1,2,3,4,5,6,7,8,9]],d=c[b],e=9>=a?2:3,f=(a-1)/2-e,g=[];if(d)for(var h=0;h<d.length;h++){var i=(d[h]-1)%3,j=Math.floor((d[h]-1)/3);g.push(new JGO.Coordinate(e+i*f,e+j*f))}return g}}();